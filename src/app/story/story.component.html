<div class="story-bg">
  <canvas id="letterRain" class="canvas-bg"></canvas>
  <canvas id="heartRain" class="canvas-bg"></canvas>
  <canvas id="zigzagRain" class="canvas-bg"></canvas>
  <div class="story-content">
    <h1 class="birthday-title">🎂 Happy Birthday! 🎉</h1>
    <div class="birthday-message-wrapper">
      <div class="birthday-message-deco left">🎀</div>
      <p class="birthday-message">
        May today be a special day filled with happiness and smiles.<br />
        Happy Birthday! 💖
      </p>
      <div class="birthday-message-deco right">🎀</div>
    </div>

    <!-- Gallery Images -->
    <div class="gallery-section">
      <h2 class="gallery-title">Memory Photos</h2>
      <div class="gallery-grid">
        <ng-container *ngFor="let item of gallery; let i = index">
          <div
            class="gallery-item"
            *ngIf="item.type === 'image'"
            (click)="openMedia(i)"
          >
            <img [src]="item.src" [alt]="item.alt" />
          </div>
        </ng-container>
      </div>
    </div>

    <!-- Gallery Videos -->
    <div class="gallery-section">
      <h2 class="gallery-title">Memory Videos</h2>
      <div class="gallery-grid video-gallery-grid">
        <ng-container *ngFor="let item of gallery; let i = index">
          <div
            class="gallery-item"
            *ngIf="item.type === 'video'"
            (click)="openMedia(i)"
          >
            <div class="video-thumb">
              <video
                [src]="item.src"
                [poster]="item.poster || ''"
                muted
                preload="metadata"
              ></video>
              <span class="play-icon">
                <svg width="36" height="36" viewBox="0 0 36 36" fill="none">
                  <circle cx="18" cy="18" r="18" fill="rgba(0,0,0,0.45)" />
                  <polygon points="14,11 27,18 14,25" fill="#fff" />
                </svg>
              </span>
            </div>
            <div class="video-title">{{ item.alt }}</div>
          </div>
        </ng-container>
      </div>
    </div>

    <div class="story-text">
      <div class="balloon-note">
        <div class="balloon-string"></div>
        <div class="balloon-paper">
          <div class="memory-frame">
            <p>
              On every birthday we've shared, we've created so many wonderful memories together.<br />
              Thank you for always being by my side, through happiness and sorrow.<br />
              I wish this year to be your best year yet, filled with smiles and laughter. 💖
            </p>
            <div class="memory-divider"></div>
            <p class="memory-love">
              <span class="story-highlight">Love you the most in the world 🥰</span>
            </p>
          </div>
        </div>
        <div class="balloon"></div>
      </div>
    </div>
    <hr class="story-divider" />
    <div class="story-footer">
      <span style="font-size: 1.3rem; color: #ffd966">⭐</span>
      <span>Thank you for being each other's happiness every day</span>
      <span style="font-size: 1.3rem; color: #ffd966">⭐</span>
    </div>
    <button class="story-btn" routerLink="/">กลับหน้าหลัก</button>
  </div>
  <div class="modal-backdrop" *ngIf="modalOpen" (click)="closeMedia()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="modal-close" (click)="closeMedia()">×</button>
      <button class="modal-nav left" (click)="prevMedia($event)">‹</button>
      <ng-container *ngIf="gallery[modalIndex].type === 'image'">
        <img [src]="gallery[modalIndex].src" [alt]="gallery[modalIndex].alt" />
      </ng-container>
      <ng-container *ngIf="gallery[modalIndex].type === 'video'">
        <video [src]="gallery[modalIndex].src" controls autoplay></video>
      </ng-container>
      <button class="modal-nav right" (click)="nextMedia($event)">›</button>
      <div class="modal-caption">{{ gallery[modalIndex].alt }}</div>
    </div>
  </div>
</div>
